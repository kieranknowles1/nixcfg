---
import FancyLink from './FancyLink.astro';
import Video from '../components/Video.astro';

interface Props {
  id: string
  videoId?: string
  title: string
  links?: {
    itchio?: string
    github?: string
    site?: string
  },

  feedback?: {
    author: string,
    rating: number
  },
  lazyload?: boolean
}
// TODO: Gallery
const {
  id,
  videoId,
  title,
  links,
  feedback,
  lazyload = false
} = Astro.props

const hasFeedback = feedback !== undefined;
if (hasFeedback && !Astro.slots.has('feedback')) {
  throw new Error('Project component requires a feedback slot if `feedback` prop is provided');
}

---
<article id={id}>
  <h3>{title}</h3>
  {videoId && <Video id={videoId} lazyload={lazyload} />}
  <div class={hasFeedback ? "twopane" : "centre-child"}>
    <div>
      <ul class="links-list">
        {links?.github && <FancyLink name="GitHub" icon="cib:github" href={links.github} />}
        {links?.itchio && <FancyLink name="Itch.io" icon="cib:itch-io" href={links.itchio} />}
        {links?.site && <FancyLink name="Site" icon="mdi:web" href={links.site} />}
      </ul>
      <slot name="summary"/>
      <slot name="bullets"/>
    </div>
    {hasFeedback && <div>
      <h4>Feedback</h4>
      <p>Rating: {feedback.rating}/100</p>
      <slot name="feedback"/>
      <cite>{feedback.author}</cite>
    </div>}
  </div>
</article>
