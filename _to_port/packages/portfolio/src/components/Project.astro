---
import FancyLink from './FancyLink.astro';
import Video from '../../selwonklib/astro/components/Video.astro';

interface Props {
  id: string
  videoId?: string
  title: string
  links: {
    itchio?: string
    github?: string
    url?: string
  },

  feedback?: {
    author: string,
    rating: number
  },
}
// TODO: Gallery
const {
  id,
  videoId,
  title,
  links,
  feedback,
} = Astro.props

const hasFeedback = feedback !== undefined;
if (hasFeedback && !Astro.slots.has('feedback')) {
  throw new Error('Project component requires a feedback slot if `feedback` prop is provided');
}

---
<article id={id}>
  <h3>{title}</h3>
  {videoId && <Video url={`https://r2.selwonk.uk/${videoId}`} />}
  <div class={hasFeedback ? "twopane" : "centre-child"}>
    <div>
      <ul class="links-list">
        {links.github && <FancyLink name="GitHub" icon="cib:github" href={links.github} />}
        {links.itchio && <FancyLink name="Itch.io" icon="cib:itch-io" href={links.itchio} />}
        {links.url && <FancyLink name="Web" icon="mdi:web" href={links.url} />}
      </ul>
      <slot name="summary"/>
      <slot name="bullets"/>
    </div>
    {hasFeedback && <div>
      <h4>Feedback</h4>
      <p>Rating: {feedback.rating}/100</p>
      <slot name="feedback"/>
      <cite>{feedback.author}</cite>
    </div>}
  </div>
</article>
